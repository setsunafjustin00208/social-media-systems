{"version":3,"file":"login.min.js","sources":["pages/login.js"],"sourcesContent":["var login = {\n    elements: {\n        emailInput: '#email-address',\n        passwordInput: '#password',\n        loginButton: '#login-button',\n        errorMessage: '#error-message',\n        rememberMeCheckbox: '#remember-me',\n        emailIconRight: '#email-icon-right',\n        passwordIconRight: '#password-icon-right',\n    },\n\n    processes: {\n        loginProcess: function() {\n            var self = login;\n            var email = $(self.elements.emailInput).val();\n            var password = $(self.elements.passwordInput).val();\n            var rememberMe = $(self.elements.rememberMeCheckbox).is(':checked');\n            var loginButton = $(self.elements.loginButton);\n            var errorMessageElement = $(self.elements.errorMessage);\n\n            var loginUrl = base_url + 'account/login-account';\n\n            // Disable the button and clear previous error messages\n            $(loginButton).prop('disabled', true).addClass('is-loading');\n            $(errorMessageElement).text('');\n\n            // Perform AJAX request\n            $.ajax({\n                url: loginUrl,\n                type: 'POST',\n                data: {\n                    email: email,\n                    password: password,\n                    rememberMe: rememberMe\n                },\n                success: function(response) {\n                    self.processes.handleLoginSuccess(response);\n                },\n                error: function(xhr) {\n                    self.processes.handleLoginError(xhr);\n                },\n                complete: function() {\n                    $(loginButton).prop('disabled', false).removeClass('is-loading');\n                }\n            });\n        },\n\n        handleLoginSuccess: function(response) {\n            var self = login;\n            var errorMessageElement = $(self.elements.errorMessage);\n\n            // Save credentials if \"Remember Me\" is checked\n            self.processes.rememberMe(response.userData.email, response.userData.password);\n\n            // Display success message\n            $(errorMessageElement).removeClass('is-danger').addClass('is-success');\n            $(errorMessageElement).html('<span class=\"icon is-small has-text-success\"><i class=\"fas fa-check-circle\"></i></span> ' + response.message);\n\n            // Redirect after a short delay\n            setTimeout(function() {\n                window.location.href = base_url + 'roleplay/home';\n            }, 1000);\n        },\n\n        handleLoginError: function(xhr) {\n            var self = login;\n            var errorMessageElement = $(self.elements.errorMessage);\n\n            // Extract error message from the server response\n            var response = xhr.responseJSON || {};\n            var errorMessage = response.message || 'Login failed. Please try again.';\n\n            // Display error message\n            $(errorMessageElement).removeClass('is-success').addClass('is-danger');\n            $(errorMessageElement).html('<span class=\"icon is-small has-text-danger\"><i class=\"fas fa-exclamation-triangle\"></i></span> ' + errorMessage);\n        },\n\n        rememberMe: function(email, password) {\n            var self = login;\n            var rememberMe = $(self.elements.rememberMeCheckbox).is(':checked');\n\n            if (rememberMe) {\n                localStorage.setItem('rememberedEmail', email);\n                localStorage.setItem('rememberedPassword', password);\n                localStorage.setItem('rememberMe', rememberMe);\n            } else {\n                localStorage.removeItem('rememberedEmail');\n                localStorage.removeItem('rememberedPassword');\n                localStorage.removeItem('rememberMe');\n            }\n        },\n\n        displayError: function(inputElement, message) {\n            // Create or reuse an error tooltip element\n            let tooltip = $(inputElement).next('.floating-error-tooltip');\n            if (tooltip.length === 0) {\n                tooltip = $('<div class=\"floating-error-tooltip\"></div>');\n                $(inputElement).after(tooltip);\n            }\n        \n            // Set the error message with the icon\n            tooltip.html(`\n                <span class=\"icon is-large tooltip-icon\">\n                    <i class=\"fas fa-xmark fa-lg\"></i>\n                </span>\n                <span class=\"tooltip-message\">${message}</span>\n            `);\n            // Use Floating UI to position the tooltip\n            const reference = inputElement[0];\n            const floating = tooltip[0];\n        \n            if (window.FloatingUIDOM) {\n                window.FloatingUIDOM.computePosition(reference, floating, {\n                    placement: 'right',\n                    middleware: [\n                        window.FloatingUIDOM.offset(8), // Add some spacing\n                        window.FloatingUIDOM.shift(),  // Prevent overflow\n                        window.FloatingUIDOM.flip()    // Flip if there's no space\n                    ]\n                }).then(({ x, y }) => {\n                    Object.assign(floating.style, {\n                        left: `${x}px`,\n                        top: `${y}px`,\n                        position: 'absolute',\n                        zIndex: 1000\n                    });\n                }).catch(err => {\n                    console.error('Floating UI error:', err);\n                });\n            } else {\n                console.error('FloatingUIDOM is not loaded.');\n            }\n        \n            // Show the tooltip\n            tooltip.addClass('is-visible');\n        },\n        \n        hideError: function(inputElement) {\n            const tooltip = $(inputElement).next('.floating-error-tooltip');\n            if (tooltip.length > 0) {\n                tooltip.removeClass('is-visible');\n            }\n        }\n    },\n\n    onload: {\n        getRememberedCredentials: function() {\n            var self = login;\n            var rememberedEmail = localStorage.getItem('rememberedEmail');\n            var rememberedPassword = localStorage.getItem('rememberedPassword');\n\n            if (rememberedEmail) {\n                $(self.elements.emailInput).val(rememberedEmail);\n            }\n            if (rememberedPassword) {\n                $(self.elements.passwordInput).val(rememberedPassword);\n            }\n\n            if (localStorage.getItem('rememberMe') === 'true') {\n                $(self.elements.rememberMeCheckbox).prop('checked', true);\n            } else {\n                $(self.elements.rememberMeCheckbox).prop('checked', false);\n            }\n        }\n    },\n\n    events: {\n        onLoginButtonClick: function() {\n            var self = login;\n            $(self.elements.loginButton).on('click', function(event) {\n                event.preventDefault();\n                self.processes.loginProcess();\n            });\n        },\n\n        onCheckTextInputBlur: function() {\n            var self = login;\n        \n            var emailInput = $(self.elements.emailInput);\n            var passwordInput = $(self.elements.passwordInput);\n            var emailIconRight = $(self.elements.emailIconRight);\n            var passwordIconRight = $(self.elements.passwordIconRight);\n            var loginButton = $(self.elements.loginButton);\n        \n            // Function to check if both inputs are valid\n            function validateForm() {\n                const isEmailValid = $(emailInput).val().trim() !== '';\n                const isPasswordValid = $(passwordInput).val().trim() !== '';\n                if (isEmailValid && isPasswordValid) {\n                    loginButton.prop('disabled', false); // Enable the button\n                } else {\n                    loginButton.prop('disabled', true); // Disable the button\n                }\n            }\n        \n            // Validate email input on blur\n            $(emailInput).on('blur', function() {\n                if ($(emailInput).val().trim() === '') {\n                    $(emailInput).addClass('is-danger');\n                    $(emailIconRight).addClass('fa-square-xmark');\n                    self.processes.displayError(emailInput, 'Required.');\n                } else {\n                    $(emailInput).removeClass('is-danger');\n                    $(emailIconRight).removeClass('fa-square-xmark');\n                    self.processes.hideError(emailInput);\n                }\n                validateForm(); // Check form validity\n            });\n        \n            // Validate password input on blur\n            $(passwordInput).on('blur', function() {\n                if ($(passwordInput).val().trim() === '') {\n                    $(passwordInput).addClass('is-danger');\n                    $(passwordIconRight).addClass('fa-square-xmark');\n                    self.processes.displayError(passwordInput, 'Required.');\n                } else {\n                    $(passwordInput).removeClass('is-danger');\n                    $(passwordIconRight).removeClass('fa-square-xmark');\n                    self.processes.hideError(passwordInput);\n                }\n                validateForm(); // Check form validity\n            });\n        \n            // Initial validation check\n            validateForm();\n        },\n\n        init: function() {\n            var self = login;\n            self.events.onLoginButtonClick();\n            self.events.onCheckTextInputBlur();\n        }\n    },\n\n    init: function() {\n        var self = login;\n        self.events.init();\n        self.onload.getRememberedCredentials();\n    }\n};\n\ndocument.addEventListener('DOMContentLoaded', function() {\n    login.init();\n});"],"names":["login","elements","emailInput","passwordInput","loginButton","errorMessage","rememberMeCheckbox","emailIconRight","passwordIconRight","processes","loginProcess","self","email","$","val","password","rememberMe","is","errorMessageElement","loginUrl","base_url","prop","addClass","text","ajax","url","type","data","success","response","handleLoginSuccess","error","xhr","handleLoginError","complete","removeClass","userData","html","message","setTimeout","window","location","href","responseJSON","localStorage","setItem","removeItem","displayError","inputElement","let","tooltip","next","length","after","reference","floating","FloatingUIDOM","computePosition","placement","middleware","offset","shift","flip","then","x","y","Object","assign","style","left","top","position","zIndex","catch","err","console","hideError","onload","getRememberedCredentials","rememberedEmail","getItem","rememberedPassword","events","onLoginButtonClick","on","event","preventDefault","onCheckTextInputBlur","validateForm","isEmailValid","trim","isPasswordValid","init","document","addEventListener"],"mappings":"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"}